1) Описание:

Проект представляет из себя конструктор простых полносвязных нейронных сетей с алгоритмом обратного распространения ошибки. Проект предназначен для создания и обучения полносвязных нейронных сетей для решения задач регрессии и классификации. Обучение происходит на входных данных из файла с расширением *.txt. Данные самих нейронных сетей хранятся в файлах с расширением *.bin.

2) Основные функции:

Проект разбит на 4 *.c файла.
>>>В файле my_math.c хранятся функции, отвечающие за генерацию случайных чисел и функции активации.

--функция get_rand: Генерирует случайное число с нормальным распределением в диапазоне от 0 до 1.

--функция get_rand_range: Принимает два числа double и возвращает случайное число в диапазоне от  a до b.

--функции активации:
0) sigmoid (dsigmoid - производная, для остальных функции аналогично)
1) ELU (dELU)
2) SiLU (dSiLU)
3) tanh (dtanh)
4) ReLU (dReLU)

--функция get_func:
Возвращает структуру с указателями на функцию и её производную по ключу. Ключ совпадает с номерами из предыдущего описания.


>>>В файле my_matrix.c хранятся функции, для работы с типом матриц m на n, содержащим double элементы.

--функция softmax для выходных нейронов

--функции init_doubles и init_matrixes выделяют память под массив double и массив Matrix

--функция printMatrix выводит матрицу в поток стандартного вывода данных, в стандартном или транспонированном виде

--функция create_matrix инициализирует матрицу m на n случайными значениями в интервале [a, b], если не задано, то использует значения из массива data, если не задано, то заполняет значением val.

--функция do_func_on_matrix применяет переданную функцию ко всем элементам входной матрицы.

--функция accurency считает ошибку предсказания нейронной сети, принимает на вход предсказанное значение и ответ из тернировочного сета. Используется для подсчёта accurency нейронной сети во время выполнения команды go_set 

--функция dot матричное произведение. Перемножает две матрицы в обычном или транспонированном виде. При этом переданная функция применяется к элементам матрицы b. Также возможно передать матрицу alpha, которая поэлементно прибавляется к результатирующей матрице. Матрица teta поэлементно домножается на результат, есть возможность передать функцию, которая будет применятся к элементам teta.
В полном виде (при всех аргументах не равных NULL) данная функция выполняет следующую математическую операцию: 
ans = (<a.T, f(b.T)> + alpha) * f_teta(teta)

--функции sub и mul соотвественно вычитают и умножают матрицы поэлементно, аргументы одинаковые. Есть возможность применить переданную функцию к элементам матрицы b перед вычитанием/умножением. Скаляр alpha умножается на результат.

--функция copy_data копирует все элементы из одной матрицы в другую

--функция free_matrix очищает память переданной матрицы


>>>В файле my_neuralnetwork.c определены функции для работы с типом нейронных сетей.
Тип NeuralNetwork хранит количество слоёв, количество нейронов на каждом слое, веса, значения смещений, функцию активации для скрытых нейронов, функцию активации для выходного слоя.

--функция create_network создаёт нейронную сеть с заданными параметрами размеров и случайными значениями весов и нейронов смещения.

--функция reset_network сбрасывает значения весов и смещений к случайным.

--функция add_biases добавляет случайные смещения к нейронной сети, если их ещё нет.

--функция delete_biases удаляет смещения, если они уже есть у модели.

--функция save_network сохраняет нейронную сеть в *.bin файл. Порядок данных и количество байт на элемент: ключ функции активации скрытого слоя(4) -> ключ функции активации выходного слоя(4) -> количество слоёв (4) -> список количсетва нейронов на слой (4) -> наличие в нейронной сети смещений(1) -> использование фукции softmax сетью(1) -> пары списков веса для слоя и смещения для слоя (8)

--функция load_network загружает все параметры нейронной сети из *.bin файла, если возможно.

--функция free_network освобожлает память переданной нейронной сети.


>>>В файле main.c определены функции для обучения нейронных сетей и взаимодействия с пользователем

--функция go_forward предсказывает выходное значение нейронной сети по входным данным.

--функция backpropagetion выполняет обратное распространение ошибки за счёт градиентного спуска.

3) Работа программы:

В программе поддерживается 19 команд:
1) load -> программа считывает название bin-файла без расширения, и загружает нейронную сеть из переданного файла. Выводит параметры нейронной сети
2) create -> сичтывает количество слоёв и количество нейронов на каждом слое, потом считывает коды функций активации скрытых слоёв и выходного слоя, далее, считывается диапазон весов, наличие/отсутвие смещений, диапазон значний для смещений, использовать/не сипользовать softmax
3) finish -> завершает работу программы и очищает всю выделнную в процессе память
!!!Программы ниже не доступны, пока не выполнена хоть одна сверху, за исключением finish!!!
4) save -> записывает нейронную сеть в бинарный файл в папку saved с названием, переданным как аргумент
5) output -> записывает нейронную сеть текстовый файл, веса записываются в виде матриц, столбцы соответсвуют входным нейронам весов, а строки - выходным
6) open_set -> считывает тренировачный сет для нейронной сети, по переданному пути без расширения файла (без этой команды не будут работать команды go_set и train)
7) forward -> выполняет функцию go_forward со входными данными, переданными как аргументы
8) go_set -> выводит результаты прохода сета, загруженного командой open_set, и считает точность работы нейроннойт сети
9) set_train_params -> устанавливает параметры для обучения сначала скорость обучения, потом - количество эпох (по умолчанию 0.001 и 1)
10) train -> обучает нейронную сеть с параметрами, установленными в set_train_params, выводит прогресс обучения в консоль
11) off_biases -> выключает смещения в нейронной сети
12) on_biases -> включает смещения в нейронной сети
!!!off/on_biases работают, только если смещения есть у нейронной сети!!!
13) add_biases -> добавляет смещения, если их ещё нет у нейронной сети
14) delete_biases -> удаляет смещения, если они есть у нейронной сети
15) reset -> задают случайные значения для весов и смещений (если они есть). Сначала вводится диапазон для весов, потом для смещений
16) set_hidden_f -> позволяет изменять функцию активации для скрытого слоя
17) set_output_f -> аналогично для выходного слоя
18) off_softmax -> выключает softmax для нейронной сети
19) on_softmax -> включает softmax

В папке с программой должны быть 4 си файла, описанных выше, и три заголовочных файла для my_math, my_matrix, my_neuralnetwork. И три папки: example, saved, output. В папке example хранятся файлы для примера, решения задачи классификации ирисов. В папку saved сохраняются бинарные файлы командой save, а в папке output будут лежать файлы, созданные команой output.

Содержимое папки example:
fishers_irises.bin - необученная нейроння сеть
fishers_irises_trained.bin - уже обученная нейронная сеть
fishers_irises_set.txt - обучающий набор данных
fishers_irises_trained.txt - вывод параметров обученной нейронной сети
fishers_irises_out.txt - пример вывода команды go_set для обученной нейронной сети

Для сборки программы необходим gcс. В командной строке нужно при помощи команды cd или аналогичной попасть в папку, где лежат перечисленные выше файлы, и ввести команду gcc -o project main.c my_math.c my_matrix.c my_neuralnetwork.c.
После чего в папке появится файл project.exe. Файл можно запустить, и начать работу с программой.

Пример работы с командами проекта:

--Вводим команду load и передаём название необученной нейроной сети для ирисов Фишера
cmd> load
arg> example\fishers_irises
--Можно обновить веса командой reset
cmd> reset
arg> -1 1
biases> -1 1
--Загружаем тренировочный сет
cmd> open_set
arg> example\fishers_irises_set
--Можем вывести необученную нейронную сеть в текстовый файл
cmd> output
arg> new1
--Запустим команду go_set
cmd> go_set
--Вам выведутся ответы нейронной сети и её точность до обучения
--Теперь установим параметры обучения
cmd> set_train_params
arg> 0.0002 600
--Теперь можем обучить нейронную сеть
cmd> train
--После завершения процесса выведем нейронную сеть в output для сравнения весов обученной и необученной сети
cmd> output
arg> new2
--Теперь посчитаем ошибку вычисления
cmd> go_set
--Можно сохранить нейронную сеть в бинарный файл
cmd> save
arg> res
--Теперь монжно завершить работу программы
cmd> finish

Вариант создания нейронной сети без исходного файла:
cmd> create
arg> 3 4 10 3
functions> 4 -1  --выбираем функции активации - ReLU и linear
weights> -1 1
with biases> 1 --будем использовать смещения
biases> -1 1
with softmax> 1  --вместо выходной функции возьмём softmax
